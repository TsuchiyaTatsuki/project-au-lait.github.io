import{t as he,a as ye}from"./index.B8F2K2P5.js";import{r as ge,z as h}from"./scheduler.BqBfJSO4.js";import{_ as G}from"./preload-helper.D6kgxu3v.js";import{w as R,d as x}from"./index.BEbAYfep.js";function et(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}function tt(t,r){he(t,1,1,()=>{r.delete(t.key)})}function at(t,r,e,a,l,i,o,s,c,n,f,y){let p=t.length,w=i.length,v=p;const g={};for(;v--;)g[t[v].key]=v;const k=[],V=new Map,b=new Map,$=[];for(v=w;v--;){const m=y(l,i,v),j=e(m);let P=o.get(j);P?$.push(()=>P.p(m,r)):(P=n(j,m),P.c()),V.set(j,k[v]=P),j in g&&b.set(j,Math.abs(v-g[j]))}const A=new Set,B=new Set;function M(m){ye(m,1),m.m(s,f),o.set(m.key,m),f=m.first,w--}for(;p&&w;){const m=k[w-1],j=t[p-1],P=m.key,S=j.key;m===j?(f=m.first,p--,w--):V.has(S)?!o.has(P)||A.has(P)?M(m):B.has(S)?p--:b.get(P)>b.get(S)?(B.add(P),M(m)):(A.add(S),p--):(c(j,o),p--)}for(;p--;){const m=t[p];V.has(m.key)||c(m,o)}for(;w;)M(k[w-1]);return ge($),k}var me=Object.defineProperty,ve=Object.defineProperties,be=Object.getOwnPropertyDescriptors,N=Object.getOwnPropertySymbols,te=Object.prototype.hasOwnProperty,ae=Object.prototype.propertyIsEnumerable,J=(t,r,e)=>r in t?me(t,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[r]=e,u=(t,r)=>{for(var e in r||(r={}))te.call(r,e)&&J(t,e,r[e]);if(N)for(var e of N(r))ae.call(r,e)&&J(t,e,r[e]);return t},O=(t,r)=>ve(t,be(r)),D=(t,r)=>{var e={};for(var a in t)te.call(t,a)&&r.indexOf(a)<0&&(e[a]=t[a]);if(t!=null&&N)for(var a of N(t))r.indexOf(a)<0&&ae.call(t,a)&&(e[a]=t[a]);return e},K=["error","warn","debug"],re=({logger:t=console,level:r=K[1],prefix:e="[i18n]: "})=>K.reduce((a,l,i)=>O(u({},a),{[l]:o=>K.indexOf(r)>=i&&t[l](`${e}${o}`)}),{}),d=re({}),ke=t=>{d=t},Q=t=>{var r=t,{parser:e,key:a,params:l,translations:i,locale:o,fallbackLocale:s}=r,c=D(r,["parser","key","params","translations","locale","fallbackLocale"]);if(!a)return d.warn(`No translation key provided ('${o}' locale). Skipping translation...`),"";if(!o)return d.warn(`No locale provided for '${a}' key. Skipping translation...`),"";let n=(i[o]||{})[a];if(s&&n===void 0&&(d.debug(`No translation provided for '${a}' key in locale '${o}'. Trying fallback '${s}'`),n=(i[s]||{})[a]),n===void 0){if(d.debug(`No translation provided for '${a}' key in fallback '${s}'.`),c.hasOwnProperty("fallbackValue"))return c.fallbackValue;d.warn(`No translation nor fallback found for '${a}' .`)}return e.parse(n,l,o,a)},L=(...t)=>t.length?t.filter(r=>!!r).map(r=>{let e=`${r}`.toLowerCase();try{let[a]=Intl.Collator.supportedLocalesOf(r);if(!a)throw new Error;e=a}catch{d.warn(`'${r}' locale is non-standard.`)}return e}):[],F=(t,r,e)=>{if(r&&Array.isArray(t))return t.map(a=>F(a,r));if(t&&typeof t=="object"){let a=Object.keys(t).reduce((l,i)=>{let o=t[i],s=e?`${e}.${i}`:`${i}`;return o&&typeof o=="object"&&!(r&&Array.isArray(o))?u(u({},l),F(o,r,s)):O(u({},l),{[s]:F(o,r)})},{});return Object.keys(a).length?a:null}return t},we=t=>t.reduce((r,{key:e,data:a,locale:l})=>{if(!a)return r;let[i]=L(l),o=O(u({},r[i]||{}),{[e]:a});return O(u({},r),{[i]:o})},{}),Oe=async t=>{try{let r=await Promise.all(t.map(e=>{var a=e,{loader:l}=a,i=D(a,["loader"]);return new Promise(async o=>{let s;try{s=await l()}catch(c){d.error(`Failed to load translation. Verify your '${i.locale}' > '${i.key}' Loader.`),d.error(c)}o(O(u({loader:l},i),{data:s}))})}));return we(r)}catch(r){d.error(r)}return{}},$e=t=>r=>{try{if(typeof r=="string")return r===t;if(typeof r=="object")return r.test(t)}catch{d.error("Invalid route config!")}return!1},U=(t,r)=>{let e=!0;try{e=Object.keys(t).filter(a=>t[a]!==void 0).every(a=>t[a]===r[a])}catch{}return e},X=1e3*60*60*24,Le=class{constructor(r){this.cachedAt=0,this.loadedKeys={},this.currentRoute=R(),this.config=R(),this.isLoading=R(!1),this.promises=new Set,this.loading={subscribe:this.isLoading.subscribe,toPromise:(e,a)=>{let{fallbackLocale:l}=h(this.config),i=Array.from(this.promises).filter(o=>{let s=U({locale:L(e)[0],route:a},o);return l&&(s=s||U({locale:L(l)[0],route:a},o)),s}).map(({promise:o})=>o);return Promise.all(i)},get:()=>h(this.isLoading)},this.privateRawTranslations=R({}),this.rawTranslations={subscribe:this.privateRawTranslations.subscribe,get:()=>h(this.rawTranslations)},this.privateTranslations=R({}),this.translations={subscribe:this.privateTranslations.subscribe,get:()=>h(this.translations)},this.locales=O(u({},x([this.config,this.privateTranslations],([e,a])=>{if(!e)return[];let{loaders:l=[]}=e,i=l.map(({locale:s})=>s),o=Object.keys(a).map(s=>s);return Array.from(new Set([...L(...i),...L(...o)]))},[])),{get:()=>h(this.locales)}),this.internalLocale=R(),this.loaderTrigger=x([this.internalLocale,this.currentRoute],([e,a],l)=>{var i,o;e!==void 0&&a!==void 0&&!(e===((i=h(this.loaderTrigger))==null?void 0:i[0])&&a===((o=h(this.loaderTrigger))==null?void 0:o[1]))&&(d.debug("Triggering translation load..."),l([e,a]))},[]),this.localeHelper=R(),this.locale={subscribe:this.localeHelper.subscribe,forceSet:this.localeHelper.set,set:this.internalLocale.set,update:this.internalLocale.update,get:()=>h(this.locale)},this.initialized=x([this.locale,this.currentRoute,this.privateTranslations],([e,a,l],i)=>{h(this.initialized)||i(e!==void 0&&a!==void 0&&!!Object.keys(l).length)}),this.translation=x([this.privateTranslations,this.locale,this.isLoading],([e,a,l],i)=>{let o=e[a];o&&Object.keys(o).length&&!l&&i(o)},{}),this.t=O(u({},x([this.config,this.translation],e=>{var[a]=e,l=a,{parser:i,fallbackLocale:o}=l,s=D(l,["parser","fallbackLocale"]);return(c,...n)=>Q(u({parser:i,key:c,params:n,translations:this.translations.get(),locale:this.locale.get(),fallbackLocale:o},s.hasOwnProperty("fallbackValue")?{fallbackValue:s.fallbackValue}:{}))})),{get:(e,...a)=>h(this.t)(e,...a)}),this.l=O(u({},x([this.config,this.translations],e=>{var[a,...l]=e,i=a,{parser:o,fallbackLocale:s}=i,c=D(i,["parser","fallbackLocale"]),[n]=l;return(f,y,...p)=>Q(u({parser:o,key:y,params:p,translations:n,locale:f,fallbackLocale:s},c.hasOwnProperty("fallbackValue")?{fallbackValue:c.fallbackValue}:{}))})),{get:(e,a,...l)=>h(this.l)(e,a,...l)}),this.getLocale=e=>{let{fallbackLocale:a}=h(this.config)||{},l=e||a;if(!l)return;let i=this.locales.get();return i.find(o=>L(l).includes(o))||i.find(o=>L(a).includes(o))},this.setLocale=e=>{if(e&&e!==h(this.internalLocale))return d.debug(`Setting '${e}' locale.`),this.internalLocale.set(e),this.loading.toPromise(e,h(this.currentRoute))},this.setRoute=e=>{if(e!==h(this.currentRoute)){d.debug(`Setting '${e}' route.`),this.currentRoute.set(e);let a=h(this.internalLocale);return this.loading.toPromise(a,e)}},this.loadConfig=async e=>{await this.configLoader(e)},this.getTranslationProps=async(e=this.locale.get(),a=h(this.currentRoute))=>{let l=h(this.config);if(!l||!e)return[];let i=this.translations.get(),{loaders:o,fallbackLocale:s="",cache:c=X}=l||{},n=Number.isNaN(+c)?X:+c;this.cachedAt?Date.now()>n+this.cachedAt&&(d.debug("Refreshing cache."),this.loadedKeys={},this.cachedAt=0):(d.debug("Setting cache timestamp."),this.cachedAt=Date.now());let[f,y]=L(e,s),p=i[f],w=i[y],v=(o||[]).map(g=>{var k=g,{locale:V}=k,b=D(k,["locale"]);return O(u({},b),{locale:L(V)[0]})}).filter(({routes:g})=>!g||(g||[]).some($e(a))).filter(({key:g,locale:k})=>k===f&&(!p||!(this.loadedKeys[f]||[]).includes(g))||s&&k===y&&(!w||!(this.loadedKeys[y]||[]).includes(g)));if(v.length){this.isLoading.set(!0),d.debug("Fetching translations...");let g=await Oe(v);this.isLoading.set(!1);let k=Object.keys(g).reduce((b,$)=>O(u({},b),{[$]:Object.keys(g[$])}),{}),V=v.filter(({key:b,locale:$})=>(k[$]||[]).some(A=>`${A}`.startsWith(b))).reduce((b,{key:$,locale:A})=>O(u({},b),{[A]:[...b[A]||[],$]}),{});return[g,V]}return[]},this.addTranslations=(e,a)=>{if(!e)return;let l=h(this.config),{preprocess:i}=l||{};d.debug("Adding translations...");let o=Object.keys(e||{});this.privateRawTranslations.update(s=>o.reduce((c,n)=>O(u({},c),{[n]:u(u({},c[n]||{}),e[n])}),s)),this.privateTranslations.update(s=>o.reduce((c,n)=>{let f=!0,y=e[n];return typeof i=="function"&&(y=i(y)),(typeof i=="function"||i==="none")&&(f=!1),O(u({},c),{[n]:u(u({},c[n]||{}),f?F(y,i==="preserveArrays"):y)})},s)),o.forEach(s=>{let c=Object.keys(e[s]).map(n=>`${n}`.split(".")[0]);a&&(c=a[s]),this.loadedKeys[s]=Array.from(new Set([...this.loadedKeys[s]||[],...c||[]]))})},this.loader=async([e,a])=>{let l=this.getLocale(e)||void 0;d.debug(`Adding loader promise for '${l}' locale and '${a}' route.`);let i=(async()=>{let o=await this.getTranslationProps(l,a);o.length&&this.addTranslations(...o)})();this.promises.add({locale:l,route:a,promise:i}),i.then(()=>{l&&this.locale.get()!==l&&this.locale.forceSet(l)})},this.loadTranslations=(e,a=h(this.currentRoute)||"")=>{let l=this.getLocale(e);if(l)return this.setRoute(a),this.setLocale(l),this.loading.toPromise(l,a)},this.loaderTrigger.subscribe(this.loader),this.isLoading.subscribe(async e=>{e&&this.promises.size&&(await this.loading.toPromise(),this.promises.clear(),d.debug("Loader promises have been purged."))}),r&&this.loadConfig(r)}async configLoader(r){if(!r)return d.error("No config provided!");let e=r,{initLocale:a,fallbackLocale:l,translations:i,log:o}=e,s=D(e,["initLocale","fallbackLocale","translations","log"]);o&&ke(re(o)),[a]=L(a),[l]=L(l),d.debug("Setting config."),this.config.set(u({initLocale:a,fallbackLocale:l,translations:i},s)),i&&this.addTranslations(i),a&&await this.loadTranslations(a)}},le=Object.defineProperty,je=Object.defineProperties,Pe=Object.getOwnPropertyDescriptors,E=Object.getOwnPropertySymbols,ie=Object.prototype.hasOwnProperty,oe=Object.prototype.propertyIsEnumerable,Y=(t,r,e)=>r in t?le(t,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[r]=e,T=(t,r)=>{for(var e in r||(r={}))ie.call(r,e)&&Y(t,e,r[e]);if(E)for(var e of E(r))oe.call(r,e)&&Y(t,e,r[e]);return t},q=(t,r)=>je(t,Pe(r)),_=(t,r)=>{var e={};for(var a in t)ie.call(t,a)&&r.indexOf(a)<0&&(e[a]=t[a]);if(t!=null&&E)for(var a of E(t))r.indexOf(a)<0&&oe.call(t,a)&&(e[a]=t[a]);return e},Te=(t,r)=>{for(var e in r)le(t,e,{get:r[e],enumerable:!0})},se={};Te(se,{ago:()=>Fe,currency:()=>Ne,date:()=>xe,eq:()=>W,gt:()=>ce,gte:()=>Ae,lt:()=>ne,lte:()=>_e,ne:()=>Ve,number:()=>Re});var I=(t,r)=>{let{modifierDefaults:e}=r||{},{[t]:a}=e||{};return a||{}},W=({value:t,options:r=[],defaultValue:e=""})=>(r.find(({key:a})=>`${a}`.toLowerCase()===`${t}`.toLowerCase())||{}).value||e,Ve=({value:t,options:r=[],defaultValue:e=""})=>(r.find(({key:a})=>`${a}`.toLowerCase()!==`${t}`.toLowerCase())||{}).value||e,ne=({value:t,options:r=[],defaultValue:e=""})=>(r.sort((a,l)=>+a.key-+l.key).find(({key:a})=>+t<+a)||{}).value||e,ce=({value:t,options:r=[],defaultValue:e=""})=>(r.sort((a,l)=>+l.key-+a.key).find(({key:a})=>+t>+a)||{}).value||e,_e=({value:t,options:r=[],defaultValue:e=""})=>W({value:t,options:r,defaultValue:ne({value:t,options:r,defaultValue:e})}),Ae=({value:t,options:r=[],defaultValue:e=""})=>W({value:t,options:r,defaultValue:ce({value:t,options:r,defaultValue:e})}),Re=({value:t,props:r,defaultValue:e="",locale:a="",parserOptions:l})=>{if(!a)return"";let i=I("number",l),{maximumFractionDigits:o}=i,s=_(i,["maximumFractionDigits"]),c=(r==null?void 0:r.number)||{},{maximumFractionDigits:n=o||2}=c,f=_(c,["maximumFractionDigits"]);return new Intl.NumberFormat(a,T(q(T({},s),{maximumFractionDigits:n}),f)).format(+t||+e)},xe=({value:t,props:r,defaultValue:e="",locale:a="",parserOptions:l})=>{if(!a)return"";let i=_(I("date",l),[]),o=_((r==null?void 0:r.date)||{},[]);return new Intl.DateTimeFormat(a,T(T({},i),o)).format(+t||+e)},z=[{key:"second",multiplier:1e3},{key:"minute",multiplier:60},{key:"hour",multiplier:60},{key:"day",multiplier:24},{key:"week",multiplier:7},{key:"month",multiplier:13/3},{key:"year",multiplier:12}],ue=(t="",r="")=>new RegExp(`^${t}s?$`).test(r),De=t=>z.indexOf(z.find(({key:r})=>ue(r,t))),Se=(t,r)=>z.reduce(([e,a],{key:l,multiplier:i},o)=>{if(ue(a,r))return[e,a];if(!a||o===De(a)+1){let s=Math.round(e/i);if(!a||Math.abs(s)>=1||r!=="auto")return[s,l]}return[e,a]},[t,""]),Fe=({value:t,defaultValue:r="",locale:e="",props:a,parserOptions:l})=>{if(!e)return"";let i=I("ago",l),{format:o,numeric:s}=i,c=_(i,["format","numeric"]),n=(a==null?void 0:a.ago)||{},{format:f=o||"auto",numeric:y=s||"auto"}=n,p=_(n,["format","numeric"]),w=+t||+r,v=Se(w,f);return new Intl.RelativeTimeFormat(e,T(q(T({},c),{numeric:y}),p)).format(...v)},Ne=({value:t,defaultValue:r="",locale:e="",props:a,parserOptions:l})=>{if(!e)return"";let i=I("currency",l),{ratio:o,currency:s}=i,c=_(i,["ratio","currency"]),n=(a==null?void 0:a.currency)||{},{ratio:f=o||1,currency:y=s}=n,p=_(n,["ratio","currency"]);return new Intl.NumberFormat(e,T(q(T({},c),{style:"currency",currency:y}),p)).format(f*(t||r))},Ee=t=>typeof t=="string"&&/{{(?:(?!{{|}}).)+}}/.test(t),H=t=>typeof t=="string"?t.replace(/\\(?=:|;|{|})/g,""):t,Ce=({value:t,props:r,payload:e,parserOptions:a,locale:l})=>`${t}`.replace(/{{\s*(?:(?!{{|}}).)+\s*}}/g,i=>{let o=H(`${i.match(/(?!{|\s).+?(?!\\[:;]).(?=\s*(?:[:;]|}}$))/)}`),s=e==null?void 0:e[o],[,c=""]=i.match(/.+?(?!\\;).;\s*default\s*:\s*([^\s:;].+?(?:\\[:;]|[^;}])*)(?=\s*(?:;|}}$))/i)||[];c=c||(e==null?void 0:e.default)||"";let[,n=""]=i.match(/{{\s*(?:[^;]|(?:\\;))+\s*(?:(?!\\:).[:])\s*(?!\s)((?:\\;|[^;])+?)(?=\s*(?:[;]|}}$))/i)||[];if(s===void 0&&n!=="ne")return c;let f=!!n,{customModifiers:y}=a||{},p=T(T({},se),y||{});n=Object.keys(p).includes(n)?n:"eq";let w=p[n],v=(i.match(/[^\s:;{](?:[^;]|\\[;])+[^:;}]/gi)||[]).reduce((g,k,V)=>{if(V>0){let b=H(`${k.match(/(?:(?:\\:)|[^:])+/)}`.trim()),$=`${k.match(/(?:(?:\\:)|[^:])+$/)}`.trimStart();if(b&&b!=="default"&&$)return[...g,{key:b,value:$}]}return g},[]);return!f&&!v.length?s:w({value:s,options:v,props:r,defaultValue:c,locale:l,parserOptions:a})}),de=({value:t,props:r,payload:e,parserOptions:a,locale:l})=>{if(Ee(t)){let i=Ce({value:t,payload:e,props:r,parserOptions:a,locale:l});return de({value:i,payload:e,props:r,parserOptions:a,locale:l})}else return H(t)},Ie=t=>({parse:(r,[e,a],l,i)=>(e!=null&&e.default&&r===void 0&&(r=e.default),r===void 0&&(r=i),de({value:r,payload:e,props:a,parserOptions:t,locale:l}))}),Me=Ie,Ke=Object.defineProperty,ze=Object.defineProperties,He=Object.getOwnPropertyDescriptors,C=Object.getOwnPropertySymbols,fe=Object.prototype.hasOwnProperty,pe=Object.prototype.propertyIsEnumerable,Z=(t,r,e)=>r in t?Ke(t,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[r]=e,qe=(t,r)=>{for(var e in r||(r={}))fe.call(r,e)&&Z(t,e,r[e]);if(C)for(var e of C(r))pe.call(r,e)&&Z(t,e,r[e]);return t},We=(t,r)=>ze(t,He(r)),Be=(t,r)=>{var e={};for(var a in t)fe.call(t,a)&&r.indexOf(a)<0&&(e[a]=t[a]);if(t!=null&&C)for(var a of C(t))r.indexOf(a)<0&&pe.call(t,a)&&(e[a]=t[a]);return e},ee=t=>{var r=t,{parserOptions:e={}}=r,a=Be(r,["parserOptions"]);return We(qe({},a),{parser:Me(e)})},Ge=class extends Le{constructor(r){super(r&&ee(r)),this.loadConfig=e=>super.configLoader(ee(e))}},Je=Ge;const Qe={loaders:[{locale:"en",key:"msg",loader:async()=>(await G(async()=>{const{default:t}=await import("./en.CyVh23if.js");return{default:t}},[],import.meta.url)).default},{locale:"ja",key:"msg",loader:async()=>(await G(async()=>{const{default:t}=await import("./ja.DghDJDno.js");return{default:t}},[],import.meta.url)).default}]},{t:it,locale:ot,locales:st,loading:nt,loadTranslations:ct}=new Je(Qe);export{ot as a,st as b,et as e,ct as l,tt as o,it as t,at as u};
